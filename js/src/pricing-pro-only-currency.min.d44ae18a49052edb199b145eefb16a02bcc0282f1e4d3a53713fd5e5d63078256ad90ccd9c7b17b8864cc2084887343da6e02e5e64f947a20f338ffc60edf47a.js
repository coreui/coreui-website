const CURRENCIES=["USD","EUR","GBP","RON","AUD","CAD","CHF","CZK","DKK","HUF","JPY","NOK","PLN","SEK","TRY","RUB","CNY","BGN","HRK","BRL","HKD","IDR","KRW","MXN","MYR","NZD","PHP","SGD","ZAR","MDL","AED","EGP","INR","RSD","UAH","TWD","ILS","QAR","SAR","ARS","CLP","BOB","COP","DOP","PYG","PEN","UYU","NGN","NAD","TND","DZD","KES","MAD","PKR","THB","BYN"],EM_CURRENCIES=["PLN","ARS","BRL","BGN","CLP","CNY","COP","CZK","EGP","HUF","INR","IDR","MYR","MXN","MAD","NGN","PKR","PEN","PHP","QAR","RON","RUB","SAR","ZAR","TWD","THB","TRY","UAH","AED","TND"],popoverTriggerList=[].slice.call(document.querySelectorAll('[data-toggle="popover"]')),popoverList=popoverTriggerList.map(a=>new coreui.Popover(a)),userLang=()=>navigator.language||navigator.userLanguage,formatCurrency=(a,b)=>new Intl.NumberFormat(userLang,{style:"currency",currency:b,minimumFractionDigits:0}).format(a),getQueryParams=(b,c)=>{let d=c,e=new RegExp("[?&]"+b+"=([^&#]*)","i"),a=e.exec(d);return a?a[1]:null},getOldPrice=(a,c,b)=>{if(a.Prices.Old.length>0){const d=a.Prices.Old.filter(a=>a.Currency===c).filter(a=>b>=a.MinQuantity).filter(a=>b<=a.MaxQuantity);return d[0].Amount}return 0},getCurrentPrice=(b,c,a)=>{const d=b.Prices.Regular.filter(a=>a.Currency===c).filter(b=>a>=b.MinQuantity).filter(b=>a<=b.MaxQuantity);return d[0].Amount},getEMPrice=(b,c,a)=>{const d=b.Prices.Regular.filter(a=>a.Currency===c).filter(b=>a>=b.MinQuantity).filter(b=>a<=b.MaxQuantity);return d[0].Amount*.6},updatePriceBasedOnQuantity=(a,g,c)=>{const d=document.getElementById(`select-${a}`),b=document.getElementById(`buy-${a}`),e=document.getElementById(`contact-us-${a}`),f=document.getElementById(`current-price-${a}`),h=document.getElementById(`old-price-${a}`),i=document.getElementById(`price-type-${a}`);if(!d)return;d.addEventListener("change",j=>{const d=j.target.value,k=formatCurrency(getCurrentPrice(g,c,parseFloat(d))*parseFloat(d),c),a=b.href,i=a.indexOf("QTY=")!==-1?getQueryParams("QTY",a):getQueryParams("qty",a);d==="15+"?(b.style.display="none",e.style.display="inline-block",f.innerHTML="Custom",h.innerHTML=""):(b.style.display="inline-block",e.style.display="none",f.innerHTML=`${k}`,b.href=a.indexOf("QTY=")!==-1?a.replace(`QTY=${i}`,`QTY=${d}`):a.replace(`qty=${i}`,`qty=${d}`))})},pricing=b=>{console.log(b.currency);const c=b.countryCode,a=CURRENCIES.includes(b.currency)?b.currency:"USD",d=document.getElementById("payment-currency");fetch("/data/pricing.json").then(a=>a.json()).then(b=>{const c=b.Products,d=document.querySelectorAll("[data-product-name]");d.forEach(f=>{const b=f.dataset.productName,g=f.dataset.productCode,d=c.filter(a=>a.ProductCode===g)[0],h=formatCurrency(getCurrentPrice(d,a,4),a),j=formatCurrency(getEMPrice(d,a,4),a),k=formatCurrency(getOldPrice(d,a,4),a),i=document.getElementById(`current-price-${b}`),l=document.getElementById(`old-price-${b}`),e=document.getElementById(`buy-${b}`);if(e.href=e.href.indexOf("QTY=")!==-1?`${e.href}&LANG=${userLang().split("-")[0]}&CURRENCY=${a}`:`${e.href}&language=${userLang().split("-")[0]}&currency=${a}`,h)if(EM_CURRENCIES.includes(a)){const a=document.createElement("div");a.classList.add("product-em-price","text-angular"),a.innerHTML=`<div class="small"><strong>Limiteda offer!</strong><br/>-40% using code <strong>EMKT</strong></div>`,i.after(a)}updatePriceBasedOnQuantity(b,d,"USD")})}).catch(a=>{throw a}),fetch("/data/payment-methods.json").then(a=>a.json()).then(a=>{const b=document.getElementById("payment-methods"),d=a.find(a=>a.countryCode===c).methods;d.forEach(c=>{const a=document.createElement("img");a.src=`/images/payment_methods/${c.img}`,a.alt=c.alt,a.style.outline="2px solid #fff",a.style.outlineOffset="-2px",b.appendChild(a)})}).catch(a=>{throw a})};document.getElementById("pricing-new")&&(document.addEventListener("click",function(a){a.target.matches("#switch-to-template")&&(a.target.classList.add("active"),document.getElementById("switch-to-library").classList.remove("active"),document.querySelectorAll(".offer-template").forEach(a=>{a.style.display="initial"}),document.querySelectorAll(".offer-library").forEach(a=>{a.style.display="none"})),a.target.matches("#switch-to-library")&&(a.target.classList.add("active"),document.getElementById("switch-to-template").classList.remove("active"),document.querySelectorAll(".offer-template").forEach(a=>{a.style.display="none"}),document.querySelectorAll(".offer-library").forEach(a=>{a.style.display="initial"}))},!1),fetch("https://pro.ip-api.com/json/?key=EEKS6bLi6D91G1p&fields=status,message,country,countryCode,timezone,currency,query").then(a=>a.json()).then(a=>{pricing(a)}).catch(a=>{fetch("https://api.coreui.io/geo/").then(a=>a.json()).then(a=>{pricing(a)}).catch(a=>{throw a})}))